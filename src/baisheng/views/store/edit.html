
<div class="wrapper wrapper-content animated fadeInRight">

    <div class="row">

        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>{{.titleName}}</h5>
                    <div class="ibox-tools">
                        <a href="{{ urlfor "StoreController.StoreList"}}"><i class="fa fa-times"></i></a>
                    </div>
                </div>
                <div class="ibox-content">

                    <form class="form-horizontal m-t" id="signupForm" method="post" >

                        <div class="form-group">
                            <input value="{{.storeInfo.Id}}"       name="storeId"      type="hidden">
                            <input value="{{.newStoreInfo.Id}}"    name="newStoreId"   type="hidden">
                            <input value="{{.ieStoreInfo.Id}}"     name="ieStoreId"    type="hidden">
                            <input value="{{.closeStoreInfo.Id}}"  name="closeStoreId" type="hidden">

                            <label class="col-sm-2 control-label">餐厅名称</label>
                            <div class="col-sm-1">
                                <input value="{{.storeInfo.StoreName}}" id="storeName" name="storeName" class="form-control" type="text" aria-required="true" aria-invalid="true" class="error">
                            </div>

                            <label class="col-sm-1 control-label">餐厅编号</label>
                            <div class="col-sm-1" style="text-align: left">
                                <input value="{{.storeInfo.Number}}" id="number"  name="number" class="form-control" type="text" aria-required="true" aria-invalid="true" class="error">
                            </div>
                            <label class="col-sm-1 control-label">餐厅经理</label>
                            <div class="col-sm-1">
                                <input value="{{.storeInfo.Manager}}"  id="manager" name="manager" class="form-control" type="text">
                            </div>

                            <label class="col-sm-1 control-label">经理手机</label>
                            <div class="col-sm-2">
                                <input value="{{.storeInfo.ManagerPhone}}"  id="managerPhone" name="managerPhone" class="form-control" type="text">
                            </div>
                        </div>


                        <div class="form-group">
                            <label class="col-sm-2 control-label">餐厅品牌</label>
                            <div class="col-sm-1">
                                <select class="form-control m-b" name="brand" id="brand">
                                    <option value="0">请选择</option>
                                    <option  {{if eq 1 .storeInfo.Brand }} selected {{end}} value="1">肯德基</option>
                                    <option  {{if eq 2 .storeInfo.Brand }} selected {{end}} value="2">必胜客</option>
                                    <option  {{if eq 3 .storeInfo.Brand }} selected {{end}} value="3">小肥羊</option>
                                    <option  {{if eq 4 .storeInfo.Brand }} selected {{end}} value="4">塔可贝尔</option>
                                    <option  {{if eq 5 .storeInfo.Brand }} selected {{end}} value="5">咖啡</option>
                                </select>
                            </div>
                            <label class="col-sm-1 control-label">运营状态</label>
                            <div class="col-sm-1">
                                <select class="form-control m-b" name="status" id="status">
                                    <option value="0">请选择</option>
                                    <option {{if eq 1 .storeInfo.Status }} selected {{end}}  value="1">新店</option>
                                    <option {{if eq 2 .storeInfo.Status }} selected {{end}}  value="2">IE</option>
                                    <option {{if eq 3 .storeInfo.Status }} selected {{end}}  value="3">关店</option>
                                    <option {{if eq 4 .storeInfo.Status }} selected {{end}}  value="4">转加盟</option>
                                    <option {{if eq 5 .storeInfo.Status }} selected {{end}}  value="5">完成</option>
                                    <option {{if eq 6 .storeInfo.Status }} selected {{end}}  value="6">准备</option>
                                </select>
                            </div>

                            <label class="col-sm-1 control-label">餐厅宽带</label>
                            <div class="col-sm-1">
                                <select class="form-control m-b" name="network" id="network">
                                    <option  value="0">请选择</option>
                                    <option {{if eq 1 .storeInfo.Network }} selected {{end}}  value="1">联通</option>
                                    <option {{if eq 2 .storeInfo.Network }} selected {{end}}  value="2">电信</option>
                                    <option {{if eq 3 .storeInfo.Network }} selected {{end}} value="3">移动</option>
                                    <option {{if eq 4 .storeInfo.Network }} selected {{end}} value="4">小运营商</option>
                                </select>
                            </div>

                            <label class="col-sm-1 control-label">IP</label>
                            <div class="col-sm-2">
                                <input id="ip" value="{{.storeInfo.Ip}}" name="ip" class="form-control" type="text">
                            </div>
                        </div>


                        <div class="form-group">
                            <label class="col-sm-2 control-label">区经理</label>
                            <div class="col-sm-1">
                                <input value="{{.storeInfo.AreaManager}}" id="areaManager" name="areaManager" class="form-control" type="text">
                            </div>
                            <label class="col-sm-1 control-label">区域经理</label>
                            <div class="col-sm-1">
                                <input  value="{{.storeInfo.RegionalManager}}" id="regionalManager" name="regionalManager" class="form-control" type="text">
                            </div>
                            <label class="col-sm-1 control-label">营建工程师</label>
                            <div class="col-sm-1">
                                <input value="{{.storeInfo.BuildName}}" id="buildName" name="buildName" class="form-control" type="text">
                            </div>
                            <div class="form-group">
                                <label class="col-sm-1 control-label">餐厅地址</label>
                                <div class="col-sm-2">
                                    <input value="{{.storeInfo.Address}}"  id="address" name="address" class="form-control" type="text">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">开业时间</label>
                            <div class="col-sm-2">
                                <input value="{{.storeInfo.OpenTime}}" id="openTime" name="openTime" class="form-control" type="date">
                            </div>
                            <label class="col-sm-1 control-label">停业时间</label>
                            <div class="col-sm-2">
                                <input value="{{.storeInfo.CloseTime}}" id="closeTime" name="closeTime" class="form-control" type="date">
                            </div>
                            <label class="col-sm-1 control-label">餐厅待开业时间</label>
                            <div class="col-sm-2">
                                <input value="{{.storeInfo.WaitTime}}" id="waitTime" name="waitTime" class="form-control" type="date">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">临时闭店时间</label>
                            <div class="col-sm-2">
                                <input value="{{.storeInfo.TempCloseTime}}" id="tempCloseTime" name="tempCloseTime" class="form-control" type="date">
                            </div>
                            <label class="col-sm-1 control-label">装修时间</label>
                            <div class="col-sm-2">
                                <input value="{{.storeInfo.DecorationTime}}"  id="decorationTime" name="decorationTime" class="form-control" type="date">
                            </div>
                            <label class="col-sm-1 control-label">设备进场时间</label>
                            <div class="col-sm-2">
                                <input value="{{.storeInfo.DeviceTime}}"  id="deviceTime" name="deviceTime" class="form-control" type="date">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">IMS</label>
                            <div class="col-sm-2">
                                <input value="{{.storeInfo.BookStartTime}}"  id="bookStartTime" name="bookStartTime" class="form-control" type="date">
                            </div>
                            <label class="col-sm-1 control-label">CMS</label>
                            <div class="col-sm-2">
                                <input value="{{.storeInfo.EmployeeStartTime}}"   id="employeeStartTime" name="employeeStartTime" class="form-control" type="date">
                            </div>
                            <label class="col-sm-1 control-label">备注</label>
                            <div class="col-sm-2">
                                <input value="{{.storeInfo.Remark}}" id="remark" name="remark" class="form-control" type="text">
                            </div>
                        </div>

                        <div class="form-group  " id="status-detail">
                            <label class="col-sm-1 control-label"></label>
                            <div class="col-sm-9">
                                <div class="tabs-container">
                                    <div class="tabs-up">
                                        <ul class="nav nav-tabs">
                                            <li class="statusTab status1 "><a data-toggle="tab" href="#tab-8">新店</a></li>
                                            <li class="statusTab status2 "><a data-toggle="tab" href="#tab-9">IE</a></li>
                                            <li class="statusTab status3 active"><a data-toggle="tab" href="#tab-10">关店</a></li>
                                        </ul>
                                        <div class="tab-content ">
                                            <div id="tab-8" class="tab-pane statusTab status1 ">
                                                <div class="panel-body">
                                                    {{template "newStore/editNewStore.html" .}}
                                                </div>
                                            </div>
                                            <div id="tab-9" class="tab-pane statusTab status2 ">
                                                <div class="panel-body">
                                                    {{template "ieStore/editIeStore.html" .}}
                                                </div>
                                            </div>
                                            <div id="tab-10" class="tab-pane statusTab status3 active">
                                                <div class="panel-body">
                                                    {{template "closeStore/editCloseStore.html" .}}

                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>


                        <div class="form-group">
                            <div class="col-sm-8 col-sm-offset-2">
                                <button class="btn btn-primary" type="submit">提交</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{{/*<script src="/static/js/demo/form-validate-demo.js"></script>*/}}
<script>

    //以下为官方示例
    $().ready(function () {

        var uploadList = []
        //判断是否有文件上传
        $(".fileTable").change(function(){
            var fileName =  $(this).attr("name")
            uploadList.push(fileName)
        });

        //编辑页面根据 store status默认显示 tab
        var editStatus = {{.storeInfo.Status}}
        if (editStatus>= 1 && editStatus<= 3){

            $("#status-detail").removeClass("hidden")
            // $("#status-detail").show()

            $(".statusTab").removeClass("active")
            $(".status"+editStatus).addClass("active")
        }else{
            $("#status-detail").addClass("hidden")
        }


        $("#status").change(function(){

        });


        //随状态切换tab
        $("#status").change(function(){
            var status =  $(this).val()
            if (status>= 1 && status<= 3){

                $("#status-detail").removeClass("hidden")
                // $("#status-detail").show()

                $(".statusTab").removeClass("active")
                $(".status"+status).addClass("active")
            }else{
                $("#status-detail").addClass("hidden")
            }
        });

        // validate signup form on keyup and submit
        var icon = "<i class='fa fa-times-circle'></i> ";
        $("#signupForm").validate({
            rules: {
                storeName: "required",
                number: {
                    required: true,
                },
            },
            messages: {
                storeName: icon + "请输入餐厅名称",
                number: icon + "请输入餐厅编号",
            },
            submitHandler:function(form){
                var form = new FormData(document.getElementById("signupForm"));

                form.append("uploadList",uploadList)
                var url = '{{urlfor "StoreController.EditStore"}}';

                $.ajax({
                    url:url,
                    type:"post",
                    data:form,
                    processData:false,
                    contentType:false,
                    success:function(data){

                        if(data.code == 0){
                            layer.msg(data.message, {icon: 1,time:2000,offset: '400px'},function () {
                                window.location.href='{{ urlfor "StoreController.StoreList"}}'
                            });
                        }else{
                            layer.msg(data.message, {icon: 5,offset: '400px'});
                        }
                    }
                });
            }
        });

    });
</script>